<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia at Nov 28, 2012 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>
        PMD Properties</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
      <meta name="author" content="Hooper Bloob" />
      <meta name="author" content="Romain Pelisse" />
    <meta name="Date-Revision-yyyymmdd" content="20121128" />
    <meta http-equiv="Content-Language" content="en" />
        
        </head>
  <body class="composite">
    <div id="banner">
                        <a href="http://sourceforge.net/" id="bannerLeft">
                                                <img src="images/sflogo.png" alt="SourceForge" />
                </a>
                                            <a href="./" id="bannerRight">
                                                <img src="images/pmd_logo_small.jpg" alt="pmd-logo" />
                </a>
            <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
        
                <div class="xleft">
        <span id="publishDate">Last Published: 2012-11-28</span>
                  &nbsp;| <span id="projectVersion">Version: 5.0.1</span>
                          |                           <a href="http://www.sourceforge.net/" class="externalLink" title="SourceForge">SourceForge</a>
        &gt;
                          <a href="./" title="PMD">PMD</a>
        &gt;
    
        PMD Properties
              </div>
            <div class="xright">                    <a href="http://sourceforge.net/projects/pmd" class="externalLink" title="SourceForge.net Project Page">SourceForge.net Project Page</a>
            |
                        <a href="http://sourceforge.net" class="externalLink" title="Hosted by SourceForge">Hosted by SourceForge</a>
              
        
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
        
                                <h5>Overview</h5>
                  <ul>
                  <li class="none">
                          <a href="http://sourceforge.net/projects/pmd/files/pmd/5.0.1/pmd-bin-5.0.1.zip/download" class="externalLink" title="Download PMD 5.0.1">Download PMD 5.0.1</a>
            </li>
                  <li class="none">
                          <a href="https://sourceforge.net/projects/pmd/files/pmd/5.0.1/" class="externalLink" title="What's new in PMD 5.0.1">What's new in PMD 5.0.1</a>
            </li>
                  <li class="none">
                          <a href="news.html" title="PMD in the news">PMD in the news</a>
            </li>
                  <li class="none">
                          <a href="products.html" title="PMD-related products and books">PMD-related products and books</a>
            </li>
                  <li class="none">
                          <a href="bestpractices.html" title="Best practices">Best practices</a>
            </li>
                  <li class="none">
                          <a href="future.html" title="Future directions">Future directions</a>
            </li>
                  <li class="none">
                          <a href="similar-projects.html" title="Similar projects">Similar projects</a>
            </li>
                  <li class="none">
                          <a href="credits.html" title="Credits">Credits</a>
            </li>
                  <li class="none">
                          <a href="license.html" title="License">License</a>
            </li>
                  <li class="none">
                          <a href="meaning.html" title="What does 'PMD' mean?">What does 'PMD' mean?</a>
            </li>
          </ul>
                       <h5>Usage</h5>
                  <ul>
                  <li class="none">
                          <a href="installing.html" title="Installation">Installation</a>
            </li>
                  <li class="none">
                          <a href="running.html" title="Command line usage">Command line usage</a>
            </li>
                  <li class="none">
                          <a href="ant-task.html" title="Ant task usage">Ant task usage</a>
            </li>
                  <li class="none">
                          <a href="maven-plugin.html" title="Maven plugin usage">Maven plugin usage</a>
            </li>
                  <li class="none">
                          <a href="mvn-plugin.html" title="Mvn plugin usage">Mvn plugin usage</a>
            </li>
                  <li class="none">
                          <a href="integrations.html" title="IDE plugin usage">IDE plugin usage</a>
            </li>
                  <li class="none">
                          <a href="suppressing.html" title="Suppressing warnings">Suppressing warnings</a>
            </li>
                  <li class="none">
                          <a href="cpd-usage.html" title="Finding duplicated code">Finding duplicated code</a>
            </li>
                  <li class="none">
                          <a href="jspsupport.html" title="JSP support">JSP support</a>
            </li>
          </ul>
                       <h5>Customizing PMD</h5>
                  <ul>
                  <li class="none">
                          <a href="compiling.html" title="Compiling PMD">Compiling PMD</a>
            </li>
                  <li class="none">
                          <a href="howtowritearule.html" title="How to write a rule">How to write a rule</a>
            </li>
                  <li class="none">
                          <a href="xpathruletutorial.html" title="Writing XPath rules">Writing XPath rules</a>
            </li>
                  <li class="none">
                          <a href="howtomakearuleset.html" title="How to make a rule set">How to make a rule set</a>
            </li>
                  <li class="none">
                          <a href="howitworks.html" title="How it works">How it works</a>
            </li>
                  <li class="none">
                          <a href="rule-guidelines.html" title="Rule guidelines">Rule guidelines</a>
            </li>
                  <li class="none">
            <strong>PMD developers information</strong>
          </li>
                  <li class="none">
                          <a href="pmd-release-process.html" title="PMD Release Process">PMD Release Process</a>
            </li>
          </ul>
                       <h5>For example</h5>
                  <ul>
                  <li class="none">
                          <a href="../scoreboard.html" title="Run PMD on a Sourceforge project">Run PMD on a Sourceforge project</a>
            </li>
          </ul>
                       <h5>Misc.</h5>
                  <ul>
                  <li class="none">
                          <a href="http://webhostinggeeks.com/science/xpath-sourceforge-ka" class="externalLink" title="XPath tutorial (Gregorian)">XPath tutorial (Gregorian)</a>
            </li>
          </ul>
                       <h5>Rule Sets</h5>
                  <ul>
                                                                                                  <li class="expanded">
                          <a href="rules/index.html" title="ecmascript">ecmascript</a>
                    <ul>
                      <li class="none">
                          <a href="rules/ecmascript/basic.html" title="Basic Ecmascript">Basic Ecmascript</a>
            </li>
                      <li class="none">
                          <a href="rules/ecmascript/braces.html" title="Braces">Braces</a>
            </li>
                      <li class="none">
                          <a href="rules/ecmascript/unnecessary.html" title="Unnecessary">Unnecessary</a>
            </li>
              </ul>
        </li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <li class="expanded">
                          <a href="rules/index.html" title="java">java</a>
                    <ul>
                      <li class="none">
                          <a href="rules/java/android.html" title="Android">Android</a>
            </li>
                      <li class="none">
                          <a href="rules/java/basic.html" title="Basic">Basic</a>
            </li>
                      <li class="none">
                          <a href="rules/java/braces.html" title="Braces">Braces</a>
            </li>
                      <li class="none">
                          <a href="rules/java/clone.html" title="Clone Implementation">Clone Implementation</a>
            </li>
                      <li class="none">
                          <a href="rules/java/codesize.html" title="Code Size">Code Size</a>
            </li>
                      <li class="none">
                          <a href="rules/java/comments.html" title="Comments">Comments</a>
            </li>
                      <li class="none">
                          <a href="rules/java/controversial.html" title="Controversial">Controversial</a>
            </li>
                      <li class="none">
                          <a href="rules/java/coupling.html" title="Coupling">Coupling</a>
            </li>
                      <li class="none">
                          <a href="rules/java/design.html" title="Design">Design</a>
            </li>
                      <li class="none">
                          <a href="rules/java/empty.html" title="Empty Code">Empty Code</a>
            </li>
                      <li class="none">
                          <a href="rules/java/finalizers.html" title="Finalizer">Finalizer</a>
            </li>
                      <li class="none">
                          <a href="rules/java/imports.html" title="Import Statements">Import Statements</a>
            </li>
                      <li class="none">
                          <a href="rules/java/j2ee.html" title="J2EE">J2EE</a>
            </li>
                      <li class="none">
                          <a href="rules/java/javabeans.html" title="JavaBeans">JavaBeans</a>
            </li>
                      <li class="none">
                          <a href="rules/java/junit.html" title="JUnit">JUnit</a>
            </li>
                      <li class="none">
                          <a href="rules/java/logging-jakarta-commons.html" title="Jakarta Commons Logging">Jakarta Commons Logging</a>
            </li>
                      <li class="none">
                          <a href="rules/java/logging-java.html" title="Java Logging">Java Logging</a>
            </li>
                      <li class="none">
                          <a href="rules/java/migrating.html" title="Migration">Migration</a>
            </li>
                      <li class="none">
                          <a href="rules/java/naming.html" title="Naming">Naming</a>
            </li>
                      <li class="none">
                          <a href="rules/java/optimizations.html" title="Optimization">Optimization</a>
            </li>
                      <li class="none">
                          <a href="rules/java/strictexception.html" title="Strict Exceptions">Strict Exceptions</a>
            </li>
                      <li class="none">
                          <a href="rules/java/strings.html" title="String and StringBuffer">String and StringBuffer</a>
            </li>
                      <li class="none">
                          <a href="rules/java/sunsecure.html" title="Security Code Guidelines">Security Code Guidelines</a>
            </li>
                      <li class="none">
                          <a href="rules/java/typeresolution.html" title="Type Resolution">Type Resolution</a>
            </li>
                      <li class="none">
                          <a href="rules/java/unnecessary.html" title="Unnecessary">Unnecessary</a>
            </li>
                      <li class="none">
                          <a href="rules/java/unusedcode.html" title="Unused Code">Unused Code</a>
            </li>
              </ul>
        </li>
                                                                                <li class="expanded">
                          <a href="rules/index.html" title="jsp">jsp</a>
                    <ul>
                      <li class="none">
                          <a href="rules/jsp/basic-jsf.html" title="Basic JSF">Basic JSF</a>
            </li>
                      <li class="none">
                          <a href="rules/jsp/basic.html" title="Basic JSP">Basic JSP</a>
            </li>
              </ul>
        </li>
                                                              <li class="expanded">
                          <a href="rules/index.html" title="xml">xml</a>
                    <ul>
                      <li class="none">
                          <a href="rules/xml/basic.html" title="Basic XML">Basic XML</a>
            </li>
              </ul>
        </li>
                                                              <li class="expanded">
                          <a href="rules/index.html" title="xsl">xsl</a>
                    <ul>
                      <li class="none">
                          <a href="rules/xsl/xpath.html" title="XPath in XSL">XPath in XSL</a>
            </li>
              </ul>
        </li>
          </ul>
                       <h5>Project Documentation</h5>
                  <ul>
                                                                                                                                                                                                  <li class="collapsed">
                          <a href="project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                                                                                                                                                  <li class="collapsed">
                          <a href="project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
                                                                                                                   <a href="http://maven.apache.org/" title="Maven" class="poweredBy">
        <img class="poweredBy"  alt="Built by Maven" src="http://maven.apache.org/images/logos/maven-feather.png"    />
      </a>
                                                                                                    <a href="http://sourceforge.net/" title="SourceForge.net" class="poweredBy">
        <img class="poweredBy"  alt="SourceForge.net. Fast, secure and Free Open Source software downloads" src="http://sflogo.sourceforge.net/sflogo.php?group_id=56262&type=10"   width="80"  height="15" />
      </a>
                       
        
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        
    
<div class="section"><h2>Informations for PMD developer<a name="Informations_for_PMD_developer"></a></h2>
<p>Some piece of information handy to PMD developers. Clearly not everything, but some useful bits :)</p>
<div class="section"><h3>PMD properties<a name="PMD_properties"></a></h3>
	<p>The new PMD properties subsystem is intended to bring some rigor and expanded functionality to the wild world of rule properies. It defines a value type template that can be used by IDE plugins to enumerate the properties specified by individual rules and provides validation and serialization services for multi-value properties.  It uses custom serialization routines to generate human-readable values that can be edited in the XML files</p>

	<p>The subsystem implements the following property constructors with the leading name and description arguments not shown:</p>
	<ol style="list-style-type: decimal">
		<li>BooleanProperty(..., boolean defaultValue, float uiOrder)</li>
		<li>BooleanProperty(..., boolean[] defaultValues, uiOrder, maxValues) BooleanProperty(..., Boolean[] defaultValues, float uiOrder, int maxValues)</li>
		<li>IntegerProperty(..., int defaultValue, float uiOrder)</li>
		<li>IntegerProperty(..., int[]defaultValues, float uiOrder, int maxValues) IntegerProperty(..., Integer[] defaultValues, float uiOrder, int maxValues)</li>
		<li>FloatProperty</li>
		<li>FloatProperty(..., float defaultValue, float uiOrder)</li>
		<li>FloatProperty(..., float[]defaultValues, float uiOrder, int maxValues) FloatProperty(..., Float[] defaultValues, float uiOrder, int maxValues)</li>
		<li>DoubleProperty</li>
		<li>DoubleProperty(..., int defaultValue, float uiOrder)</li>
		<li>DoubleProperty (..., double[]defaultValues, float uiOrder, int maxValues) DoubleProperty (..., Double[] defaultValues, float uiOrder, int maxValues)</li>

		<li>StringProperty</li>
		<li>StringProperty(..., String defaultValue, float uiOrder)</li>
		<li>StringProperty(..., String[] defaultValues, float uiOrder, char delimiter)</li>
	</ol>
	<p>
	The delimiter character is used in the serialized string and cannot be part of the property value strings.</p>
	<ol style="list-style-type: decimal">
		<li>TypeProperty(..., Class defaultValue, float uiOrder)</li>
		<li>TypeProperty(..., Class[]defaultValues, float uiOrder)</li>
	</ol>
	<p><i>(PMD doesn&#x2019;t currently support full type resolution at the moment)</i></p>

	<ol style="list-style-type: decimal">
		<li>CharacterProperty(..., char defaultValue, float uiOrder)</li>
		<li>CharacterProperty(..., char[] defaultValues, float uiOrder, char delimiter)</li>
		<li>CharacterProperty(..., Character[] defaultValues, float uiOrder, char delimiter)</li>
		<li>CharacterProperty(..., String defaultValues, float uiOrder, char delimiter)</li>
	</ol>
	<p>The delimiter character is used in the serialized string and cannot be part of the property value characters.</p>
	<ol style="list-style-type: decimal">
		<li>EnumeratedProperty(..., Object[][] values, float uiOrder)</li>
		<li>EnumeratedProperty(..., Object[][] values, float uiOrder, int maxValues)</li>
	</ol>
	<p>
	The 2D value array holds the label-value tuples in the order that they should be presented in the UI widget. See usage below.</p>
</div>


<div class="section"><h3>For Rule developers<a name="For_Rule_developers"></a></h3>
	<p>All rule properties need to be characterized via individual PropertyDescriptors so that they can be viewed and adjusted the IDE plugin users. Since the descriptors never change at runtime we only need one of each so we create them as static singletons within the rule class definition. The following rule usage example makes use of a pair of integer properties:</p>
		<div class="source"><pre>

public MyVarNameLengthRule extends AbstractRule() {

   private static final PropertyDescriptor minVarNameLength =
new IntegerProperty(
&#x201c;minVarNameLength&#x201d;,
&#x201c;Minimum length for variable names&#x201d;,
3,
1.0f
);

   private static final PropertyDescriptor maxVarNameLength =
new IntegerProperty(
&#x201c;maxVarNameLength&#x201d;,
&#x201c;Maximum length for variable names&#x201d;,
30,
1.1f
);

private static final Map propertyDescriptorsByName = asFixedMap(
new PropertyDescriptor[] { minVarNameLength, maxVarNameLength }
);

public MyVarNameLengthRule() { };

protected Map propertiesByName() {
return propertyDescriptorsByName;
};

// rule body methods...
}

		</pre></div>
	<p>All property descriptors must be returned via the propertiesByName() method for each rule class.</p>
	<p>Properties can also be multi-valued, that is, we can capture and define a set of them at once:
		</p><div class="source"><pre>

private static final PropertyDescriptor booleanPrefixes =
new StringProperty(
&#x201c;booleanPrefixes&#x201d;,
&#x201c;Legal prefixes to use for boolean field names&#x201d;,
new String[] { &#x201c;is&#x201d;, &#x201c;has&#x201d;, &#x201c;can&#x201d; },
1.0f,
&#x2018;|&#x2019;	// reserved as delimiter
);

	</pre></div>
<p>There are at least two constructors for each property type, one that limits the property to a single value and another that accepts more than one.</p>

<p>In addition to the regular Java types such as Boolean, Integer, Float, Character, String, and Class/Type values you can also allow your rule users to pick between complex mixed datatypes such as maps or graphs that you define at compilation time:</p>
	<div class="source"><pre>

private static final Object[][] mixedItems = new Object[][] {
	{&quot;map&quot;,		new HashMap()},
	{&quot;emptyArray&quot;,	new Object[0]},
	{&quot;list&quot;,		new ArrayList()},
	{&quot;string&quot;,		&quot;Hello World!&quot;},
	};

private static final PropertyDescriptor sampleObjects =
new EnumeratedProperty(
&quot;testEnumerations&quot;,
&quot;Test enumerations with complex types&quot;,
mixedItems,
1.0f
) 
		</pre></div>
	<p>Note that Java values held by the EnumeratedProperty are not written out as property values themselves, we just write out the labels they are associated with. Specifying a label in the XML file for an object that doesn&#x2019;t exist will result in an IllegalArgumentException.</p>
</div>
<div class="section"><h3>XML values<a name="XML_values"></a></h3>
	<p>Defining the property rules within the ruleset XML files is straightforward for single values:</p>
		<div class="source"><pre>
	
	&lt;properties&gt;
	&lt;property name=&quot;maxMethodArgs&quot; value=&quot;2&quot;/&gt;
	&lt;/properties&gt;
	
		</pre></div>
	<p>When specifying multiple values you will need to separate them using the delimiter held by the property descriptor, most commonly a single pipe character, &#x2018;|&#x2019;:</p>
		<div class="source"><pre>
	
	&lt;properties&gt;
		&lt;property 	name=&quot;legalListTypes&quot;
					value=&quot;java.util.ArrayList|java.util.Vector|java.util.HashMap&quot;/&gt;
	&lt;/properties&gt;
	
		</pre></div>

	<p>You can define your own datatypes by implementing a subclass of AbstractPMDProperty and implementing the serialization, and validation routines listed in the PMDProperty interface. Just ensure that you create a corresponding JUnit test in the test.net.sourceforge.pmd.properties package to go along with it.</p>

	<p>One of the implementation goals in this system is to try and come up with property constructors sufficiently useful that we don&#x2019;t need to assemble them within static blocks. A single statement should be enough to build a rule property descriptor.</p>
</div>
</div>
<div class="section"><h2>For IDE plugin developers<a name="For_IDE_plugin_developers"></a></h2>
	<p>In order to assemble an effective UI to manage the rule properties the following setup sequence is suggested:</p>
	<ul>
		<li><p>Determine whether the value is open-ended or enumerated. For example, can the user type in their own values or should they pick them from a list? Invoke the choices() method that may return a 2D array of label-value pairs you can use to populate your list widget. If the method returns null then jump to step #2.</p><p> You may need to maintain a mapping of the label-value pairs to translate between them depending on the capabilities of your list widget. The first pair in the array represents the default property value.</p></li>
		<li>For open-ended values, determine the cardinality of the property via the maxValueCount() method. If it returns a value of one then use the type() method to determine the type-specific entry field could use next. I.e. a checkbox for booleans, text field for strings, spin buttons for ints, etc.</li>
		<li>If the property supports more than one value then you may opt to use a single text field and parse the entries after the user leaves or hits the return key or you can create a read-only widget and add/remove values via a popup dialog.</li>
		<li><p>All multi-value properties make use of a character to delimit the values in their serialized form so you will need to ensure that you prevent the user from entering values containing it. Retrive the delimiter via the multiValueDelimiter() method.</p></li>

	<p>You can use the errorFor(value) method to validate the values entered by the user or check the values held by the rule configuration file. It returns null
	or an error message as appropriate. It would be best to flag and disable rules that have invalid property values.</p>
	<p>Use the defaultValue() method to reset the rule properties to their default value.</p>
	<p>The two serialization methods, valueFrom() and asDelimitedString(), are to be used to retrive and store property values respectively. </p>
	<p>Widgets should be ordered vertically according to the values returned by the uiOrder() method with lower-valued properties appearing above the ones with higher values. The order of the property descriptors returned from the rule cannot be guaranteed to be the same as the presentation order. If the two or more widgets share the same integer value then you can use the fractional portions to place their widgets in a horizontal sequence (if possible).</p>
	<p>For types that can have null values, such as strings, then use the isRequired() method to flag any possible missing values.</p>
	<p>If a property field is multi-valued then the maximum number of values it can hold is set to largest possible int value unless set explicitly in a rule property constructor.</p>
</ul>
</div>
<div class="section"><h2>ToDo items<a name="ToDo_items"></a></h2>
	<ol style="list-style-type: decimal">
		<li>Expand this note with further examples</li>
		<li>Internationalize error strings in the code</li>
		<li>Provide for additional datatypes such as Date</li>
		<li>Figure out the best way to add the rowCount value to the StringProperty constructor</li>
	</ol>
</div>


      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
              Copyright &#169;                    2002-2012
                        <a href="http://pmd.sourceforge.net/">InfoEther</a>.
            All Rights Reserved.      
        
                  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
